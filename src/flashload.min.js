"use strict";window.FlashLoad=function(){var t={},e=!1,n="",a=[],o=2e3;function r(t){var e=location.protocol+"//"+location.host+(n?"/"+m(n):"");return!(t.target||t.hasAttribute("download")||t.href.indexOf("#")>-1&&f(t.href)==f(location.href)||0!=t.href.indexOf(e+"/")||function(t){for(var e=0;e<a;e++){var n=a[e];if("function"==typeof n&&n(t))return!0}for(;t=t.parentElement;){if(!t)return!1;if(t.hasAttribute("data-flashload-skip-preloading"))return!0}return!1}(t))}function i(t){var e=t.target.closest("a[href]");e&&r(e)&&u(e)}function s(t){if(!t.metaKey&&!t.ctrlKey){var e=t.target.closest("a[href]");e&&r(e)&&(t.preventDefault(),l(e))}}function d(t){var e=f(location.href),n=document.createElement("a");n.href=e,r(n)?l(n):location.reload()}function u(e,n){var a=e.href,o=f(a);t[o]||(t[o]=new c(a,n))}function l(e){h("navigationStarted",{url:e.href});var n=f(e.href);t[n]?t[n].display():u(e,!0)}function c(t,e,n){var a=this;this.href=t,this.status="loading",this.error=null,this.displayOnLoad=!!e,h("preloadStarted",{url:t});var o=new XMLHttpRequest;o.open("GET",t),o.timeout=2e4,o.send(),o.onreadystatechange=function(){2===o.readyState&&"text/html"!==o.getResponseHeader("Content-Type").toLowerCase()&&a.setError("Not an HTML response"),4===o.readyState&&(200!==o.status?a.setError("Request error"):a.setSuccess(o.responseText))},this.setError=function(t){this.status="error",this.error=t},this.setSuccess=function(e){this.status="success",h("preloadEnded",{url:t});var n=document.implementation.createHTMLDocument("");n.documentElement.innerHTML=e,this.title=n.title,this.body=n.body,this.displayOnLoad&&this.display()},this.xhr=o,this.display=function(){"loading"===this.status?this.displayOnLoad=!0:"error"===this.status?location.href=this.href:(history.pushState(null,null,this.href),document.title=this.title,document.documentElement.replaceChild(this.body,document.body),function(){for(var t=document.body.getElementsByTagName("script"),e=0;e<t.length;e++){var n=t[e];n.hasAttribute("data-flashload-skip-replacing")||n.parentNode.replaceChild(a(n),n)}function a(t){var e=document.createElement("script");e.text=t.innerHTML;for(var n,a=-1,o=t.attributes;++a<o.length;)e.setAttribute((n=o[a]).name,n.value);return e}}(),h("navigationEnded",{url:this.href}))}}function h(t,e){document.dispatchEvent(new CustomEvent("flashload:"+t,{detail:e,bubbles:!0,cancelable:!0,composed:!1}))}function f(t){var e=t.indexOf("#");return-1==e?t:t.substr(0,e)}function m(t){return t.replace(/^\/|\/$/g,"")}return{start:function(t){e||(e=!0,t||(t={}),t.basepath&&(n=m(t.basepath)),t.exclude&&(a=t.exclude),"number"==typeof t.barDelay&&(o=t.barDelay),t.bar&&function(t){var e=document.createElement("style");e.innerHTML="#flashload-bar-container{position:fixed;top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;transition:opacity .25s .1s;opacity:0}.flashload-bar{background:#000;width:100%;margin-left:-100%;height:2px;transition:all .25s}",document.head.appendChild(e);var n,a,o,r=!1;function i(t){a&&(a.style.transform="translate("+t+"%)"),o=t,document.getElementById(n.id)||document.body.appendChild(n)}function s(){if(r){var t=o+1+2*Math.random();t>=98&&(t=98),i(t),setTimeout(s,50)}}function d(){r&&(document.getElementById(n.id)&&document.body.removeChild(n),n.style.opacity="1",setTimeout((function(){i(10+10*Math.random())}),0),setTimeout(s,1))}(n=document.createElement("div")).id="flashload-bar-container",(a=document.createElement("div")).id="flashload-bar",a.className=a.id,n.appendChild(a),document.body.appendChild(n),document.addEventListener("flashload:navigationStarted",(function(){r=!0,setTimeout(d,t)})),document.addEventListener("flashload:navigationEnded",(function(){r=!1,document.body.appendChild(n),setTimeout((function(){i(o)}),0),setTimeout((function(){i(100),setTimeout((function(){n.style.opacity="0"}),100)}),1)}))}(o),document.addEventListener("mouseover",i,!0),document.addEventListener("click",s,!0),window.addEventListener("popstate",d,!0))}}}();
